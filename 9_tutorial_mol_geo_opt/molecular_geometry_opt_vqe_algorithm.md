# Molecular Geometry Optimization VQE Algorithm

## 基本信息
- **算法名称**: Molecular Geometry Optimization VQE (分子几何优化VQE)
- **函数名称**: run_molecular_geometry_opt_vqe
- **算法类别**: 分子几何结构优化
- **适用场景**: 寻找分子平衡几何结构、势能面探索、分子稳定性分析

## 算法描述
分子几何优化VQE通过联合优化量子电路参数和分子核坐标来寻找分子的平衡几何结构。算法将分子能量作为核坐标的函数进行最小化，同时优化描述电子态的量子电路参数。使用参数化Hamiltonian H(x)和自适应电路选择，实现高效的分子几何优化。

## 技术规格
- **最大量子比特数**: 8
- **支持分子**: 小分子系统（H2, H3+, H2O, NH3等）
- **优化算法**: 联合梯度下降优化
- **电路设计**: 自适应选择的单/双激发门
- **梯度计算**: 电路参数解析梯度 + 核坐标有限差分梯度
- **收敛准则**: 基于核梯度最大分量的化学精度标准

## 参数说明

### 必需参数
- **symbols**: 原子符号列表
- **initial_coordinates**: 初始分子几何结构（原子单位）
- **charge**: 分子电荷（默认0）

### 可选参数
- **max_iterations**: 最大优化迭代次数（默认50）
- **circuit_lr**: 电路参数学习率（默认0.8）
- **geometry_lr**: 几何坐标学习率（默认0.8）
- **gradient_threshold**: 梯度收敛阈值（默认1e-5 Ha/Bohr）
- **energy_threshold**: 能量收敛阈值（默认1e-8 Ha）
- **finite_diff_step**: 有限差分步长（默认0.01）
- **adaptive_circuit**: 是否使用自适应电路选择（默认True）
- **track_bond_lengths**: 是否跟踪键长变化（默认True）
- **max_excitations**: 最大激发操作数（默认10）

## 约束条件
- 需要JAX环境支持
- 分子大小受量子比特数限制
- 初始几何结构应接近合理值

## 算法优势
- 真正的几何-电子联合优化，避免嵌套优化
- 自适应电路设计，提高计算效率
- 支持化学精度的收敛判据
- 可视化几何优化过程
- 适用于势能面扫描和反应路径搜索
- 为量子化学几何优化提供新范式